<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>è´­ç‰©è½¦</title>
  <style>
    button {
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <h1>ğŸ›’ æ‚¨çš„è´­ç‰©è½¦</h1>
  <div id="cart-list"></div>
  <h2 id="total-price"></h2>
  <button id="clear-cart">ğŸ—‘ï¸ æ¸…ç©ºè´­ç‰©è½¦</button>
  <a href="index.html">â¬…ï¸ è¿”å›å•†åº—</a>

  <script>
    // è¯»å–æœ¬åœ°è´­ç‰©è½¦æ•°æ®
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    // åˆå¹¶é‡å¤å•†å“ï¼Œç»Ÿè®¡æ•°é‡
    function mergeCart(cart) {
      return cart.reduce((acc, item) => {
        const found = acc.find(i => i.name === item.name);
        if (found) {
          found.quantity++;
        } else {
          acc.push({...item, quantity: 1});
        }
        return acc;
      }, []);
    }

    // æ›´æ–°è´­ç‰©è½¦æ˜¾ç¤º
    function renderCart() {
      const mergedCart = mergeCart(cart);
      const cartDiv = document.getElementById("cart-list");
      cartDiv.innerHTML = "";
      let total = 0;

      if (mergedCart.length === 0) {
        cartDiv.innerHTML = "<p>è´­ç‰©è½¦ä¸ºç©º</p>";
        document.getElementById("total-price").textContent = "";
        return;
      }

      mergedCart.forEach(item => {
        cartDiv.innerHTML += `
          <p>
            ${item.name} - RM${item.price.toFixed(2)} x ${item.quantity}
            <button onclick="removeOne('${item.name}')">åˆ é™¤ä¸€ä»¶</button>
          </p>
        `;
        total += item.price * item.quantity;
      });

      document.getElementById("total-price").textContent = `æ€»é‡‘é¢ï¼šRM${total.toFixed(2)}`;
    }

    // åˆ é™¤æŸå•†å“ä¸€ä»¶
    window.removeOne = function(name) {
      // æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…å•†å“ï¼Œåˆ æ‰å®ƒ
      const index = cart.findIndex(item => item.name === name);
      if (index !== -1) {
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart();
      }
    };

    // æ¸…ç©ºè´­ç‰©è½¦æŒ‰é’®
    document.getElementById("clear-cart").onclick = function() {
      cart = [];
      localStorage.removeItem("cart");
      renderCart();
    };

    // é¡µé¢åˆå§‹æ¸²æŸ“
    renderCart();
  </script>
</body>
</html>
