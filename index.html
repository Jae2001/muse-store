<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Welcome to Muse Store</title>
    <style>
      .product {
        border: 1px solid #ccc;
        padding: 10px;
        margin: 10px;
        display: inline-block;
        text-align: center;
        width: 180px;
      }
      button {
        padding: 5px 10px;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Hello, this is Muse!</h1>
    <p>Your site is now live 🎉</p>

    <h2>🛍️ 商品列表</h2>
    <div id="product-list"></div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-app.js";
      import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD2v-BrgI9EfEMN1tcw6qh4xDXRFtBBcsw",
        authDomain: "muse-store-01.firebaseapp.com",
        projectId: "muse-store-01",
        storageBucket: "muse-store-01.firebasestorage.app",
        messagingSenderId: "590294528151",
        appId: "1:590294528151:web:b7a16dfb58a64d641579d2"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function loadProducts() {
        const querySnapshot = await getDocs(collection(db, "products"));
        const productList = document.getElementById("product-list");

        querySnapshot.forEach((doc) => {
          const data = doc.data();
          const productHTML = `
            <div class="product">
              <img src="${data.imageUrl}" alt="${data.name}" width="150" />
              <p><strong>${data.name}</strong></p>
              <p>RM${data.price}</p>
              <button onclick="addToCart('${doc.id}', '${data.name}', ${data.price})">加入购物车</button>
            </div>
          `;
          productList.innerHTML += productHTML;
        });
      }

      // 暂时用 localStorage 来储存购物车
      window.addToCart = function (id, name, price) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.push({ id, name, price });
        localStorage.setItem("cart", JSON.stringify(cart));
        alert(`✅ ${name} 已加入购物车！`);
      };

      loadProducts();
    </script>
  </body>
</html>
